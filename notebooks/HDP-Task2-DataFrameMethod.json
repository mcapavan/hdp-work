{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql import functions as f\n\n# cleansing to_date by one day\ndf_sal = sqlContext.sql(\"select * from salaries\")\ndf_sal_new = df_sal.select(df_sal.emp_no, df_sal.salary, df_sal.from_date, f.date_sub(df_sal.to_date , 1).alias(\"to_date\"))\n\n# cleansing hire_date\ndf_sal_tmp = df_sal_new.groupBy('emp_no').agg(f.min('from_date').alias('hire_date'))\ndf_emp = sqlContext.sql(\"select * from employees\")\ndf_emp_new = df_emp.join(df_sal_tmp, df_emp.emp_no == df_sal_tmp.emp_no, \"inner\")\\\n    .select(df_emp.emp_no,df_emp.birth_date, df_emp.first_name, df_emp.last_name, df_emp.gender, df_sal_tmp.hire_date)\n\n# determine employee lasted less than two weeks in the job in May 1985\ndf_sal_198505 = df_sal_new.filter(df_sal_new[\"from_date\"].rlike(\"1985-05-*\"))\ndf_emp_198505 = df_sal_198505.filter(f.datediff(df_sal_198505.to_date, df_sal_198505.from_date) < 15 )\n\ndf_emp.join(df_emp_198505, df_emp.emp_no == df_emp_198505.emp_no, \"inner\")\\\n    .select(df_emp.emp_no, df_emp.first_name, df_emp.last_name, df_emp.hire_date).show()\n\n# save cleansing data into Hive with ORC format\ndf_sal_new.write.format(\"orc\").saveAsTable(\"salaries_new\")\ndf_emp_new.write.format(\"orc\").saveAsTable(\"employees_new\")\n","dateUpdated":"2017-04-02T00:46:00+0100","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1490646293856_-1731931598","id":"20170327-202453_598780659","result":{"code":"SUCCESS","type":"TEXT","msg":"+------+----------+---------+----------+\n|emp_no|first_name|last_name| hire_date|\n+------+----------+---------+----------+\n|296678|   Boutros|  McClurg|1985-05-11|\n+------+----------+---------+----------+\n\n"},"dateCreated":"2017-03-27T08:24:53+0100","dateStarted":"2017-04-02T00:46:00+0100","dateFinished":"2017-04-02T00:46:06+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1882","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1490646423934_1849527347","id":"20170327-202703_58868380","dateCreated":"2017-03-27T08:27:03+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1883","dateUpdated":"2017-04-02T00:43:46+0100","dateFinished":"2017-04-02T00:43:46+0100","dateStarted":"2017-04-02T00:43:46+0100","errorMessage":"","text":"%hive\nDROP TABLE IF EXISTS employees_new","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491090165621_1468308373","id":"20170402-004245_2055553440","dateCreated":"2017-04-02T00:42:45+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2068","dateUpdated":"2017-04-02T00:43:42+0100","dateFinished":"2017-04-02T00:43:42+0100","dateStarted":"2017-04-02T00:43:42+0100","errorMessage":"","text":"%hive\nDROP TABLE IF EXISTS salaries_new"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491090186077_1044715158","id":"20170402-004306_2063749238","dateCreated":"2017-04-02T00:43:06+0100","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2153","errorMessage":""}],"name":"HDP-Task2-DataFrameMethod","id":"2CEFXM2EM","angularObjects":{"2BYG9GAN3:shared_process":[],"2C139U1BG:shared_process":[],"2BYWWZJPK:shared_process":[],"2C2VAKPN2:shared_process":[],"2BZC2RPUW:shared_process":[],"2BZQEH9EH:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}