{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1490897767526_-1199450895","id":"20170330-191607_190881755","dateCreated":"2017-03-30T07:16:07+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:720","text":"%pyspark\nfrom pyspark.sql import functions as f\ndf = sqlContext.sql(\"select * from salaries\")\ndf_sal = df.select(df.emp_no, df.salary, df.from_date, f.date_sub(df.to_date , 1).alias(\"to_date\"))\ndf_sal.write.format(\"orc\").saveAsTable(\"salaries_new\")\n\n\ndf_emp = sqlContext.sql(\"select t1.emp_no, t1.birth_date, t1.first_name, t1.last_name, t1.gender, t2.hire_date_new as hire_date from employees t1 join (select emp_no, min(from_date) as hire_date_new from salaries_new group by emp_no) t2 on t1.emp_no = t2.emp_no\")\ndf_emp.write.format(\"orc\").saveAsTable(\"employees_new\")\n\nsqlContext.sql(\"select E.emp_no, first_name, last_name, hire_date from employees_new E join (select emp_no from salaries_new where from_date like '1985-05-%' and datediff(to_date, from_date) < 15) S on E.emp_no = s.emp_no\").show()\n\n","dateUpdated":"2017-04-01T22:17:35+0100","dateFinished":"2017-04-01T22:18:42+0100","dateStarted":"2017-04-01T22:17:35+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"+------+----------+---------+----------+\n|emp_no|first_name|last_name| hire_date|\n+------+----------+---------+----------+\n|296678|   Boutros|  McClurg|1985-05-11|\n+------+----------+---------+----------+\n\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1490897928489_447115698","id":"20170330-191848_1599883931","dateCreated":"2017-03-30T07:18:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:791","dateUpdated":"2017-04-01T22:16:24+0100","dateFinished":"2017-04-01T22:15:53+0100","dateStarted":"2017-04-01T22:15:47+0100","errorMessage":"","text":""},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1491080995143_1467851487","id":"20170401-220955_1747833868","dateCreated":"2017-04-01T22:09:55+0100","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:908","errorMessage":""}],"name":"HDP-Task2-SparkSQLMethod","id":"2CF7FBXKQ","angularObjects":{"2BYG9GAN3:shared_process":[],"2C139U1BG:shared_process":[],"2BYWWZJPK:shared_process":[],"2C2VAKPN2:shared_process":[],"2BZC2RPUW:shared_process":[],"2BZQEH9EH:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}